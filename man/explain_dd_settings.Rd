% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/explain_dd_settings.R
\name{explain_dd_settings}
\alias{explain_dd_settings}
\title{Explain Density Dependence Settings}
\usage{
explain_dd_settings(
  life_cycles,
  habitat_dd_k = NULL,
  HUC_ID = NULL,
  verbose = TRUE
)
}
\arguments{
\item{life_cycles}{A data frame with life cycle parameters. Must have columns
\code{Name} and \code{Value} (case-insensitive). This is the same format as
used by \code{\link{pop_model_setup}}.}

\item{habitat_dd_k}{Optional data frame with habitat capacity values by location.
Should have a \code{HUC_ID} column and columns like \code{k_stage_0_mean},
\code{k_stage_1_mean}, etc. This is the same format as used by
\code{\link{build_k_for_proj_dd}}.}

\item{HUC_ID}{Character. The location identifier to look up in \code{habitat_dd_k}.
Required if \code{habitat_dd_k} is provided.}

\item{verbose}{Logical. If \code{TRUE} (default), prints the explanation to
the console. Set to \code{FALSE} to suppress output and only return the list.}
}
\value{
Invisibly returns a list with the following components:
\describe{
\item{explanation}{Character string with the full human-readable explanation}
\item{summary}{List with population_type, n_stages, adult_k, dd_methods, s0_adjusted}
\item{s0_details}{List with original_s0, s0_1_det, behavior ("ORIGINAL" or "OPTIMIZED"),
reason, and note (explains why s0 values differ, or NULL if unchanged)}
\item{compensation_ratios}{List with enabled, values, stages_with_effect}
\item{bh_dd_stages}{List with enabled, all_stages, beverton_holt, hockey_stick,
and note (identifies missing K columns or stable-stage-derived K used with
location-specific DD, or NULL if no issues)}
\item{k_values}{List with stages (named list of K values by stage, each with
value and source) and note (identifies K columns without corresponding DD
flags, or NULL if all K columns are used)}
\item{warnings}{Character vector of any configuration warnings}
}
}
\description{
A diagnostic function that takes life cycle parameters and optional habitat
capacity data and generates a human-readable explanation of what density
dependence will be applied in the population model.

This function helps users understand:
\itemize{
\item Whether s0.1.det (fry survival) will be optimized or use original values
\item Which compensation ratio stages have active density dependence (cr > 1)
\item Which Beverton-Holt or Hockey-stick stages are enabled
\item What carrying capacity (K) values will be used for each life stage
\item Any potential configuration warnings
}
}
\details{
The function analyzes the life cycle parameters to determine:

\strong{s0.1.det Optimization:}
\itemize{
\item OPTIMIZED: When \code{k} is set AND no BH/HS stages are enabled.
The fry survival rate is adjusted to give lambda = 1.0 at equilibrium.
\item ORIGINAL: When \code{k} is NA, OR when any BH/HS stage is enabled.
The original S0 value from the life cycle file is used.
}

\strong{Compensation Ratio DD:}
Applied via the D.mx matrix during projection when \code{k} is set.
Only stages with cr > 1 have active density dependence.

\strong{Beverton-Holt / Hockey-Stick DD:}
Applied in \code{dd.N.bh()} after matrix projection when any of these
parameters are set to TRUE/1: bh_stage_0, bh_stage_1, hs_stage_0, dd_hs_0,
bh_spawners, hs_spawners, etc.
}
\examples{
# Create a simple resident life cycle with compensation ratios
life_cycles <- data.frame(
  Name = c("Nstage", "anadromous", "k", "S0", "SE",
           "surv_1", "surv_2", "surv_3", "surv_4",
           "cr_E", "cr_0", "cr_1", "cr_2", "cr_3", "cr_4",
           "mat_1", "mat_2", "mat_3", "mat_4",
           "year_1", "year_2", "year_3", "year_4",
           "events", "eps", "int", "SR",
           "eps_sd", "egg_rho", "M.cv", "M.rho"),
  Value = c(4, FALSE, 500, 0.3, 0.1,
            0.5, 0.6, 0.8, 0.9,
            1, 3.5, 2.8, 2.0, 1.5, 1,
            0, 0, 0, 1,
            1, 1, 1, 1,
            1, 3000, 1, 0.5,
            100, 0.1, 0.1, 0.1),
  stringsAsFactors = FALSE
)

# Explain what DD will be applied
result <- explain_dd_settings(life_cycles)

# Access the structured results
result$summary$dd_methods
result$s0_details$behavior
result$compensation_ratios$stages_with_effect

# With habitat capacity data
habitat_k <- data.frame(
  HUC_ID = c("1", "2", "3"),
  k_stage_0_mean = c(10000, 20000, 15000),
  k_stage_1_mean = c(5000, 10000, 7500)
)

# Add BH stage to life cycle
life_cycles_bh <- rbind(life_cycles,
  data.frame(Name = "bh_stage_0", Value = "TRUE", stringsAsFactors = FALSE)
)

result2 <- explain_dd_settings(
  life_cycles = life_cycles_bh,
  habitat_dd_k = habitat_k,
  HUC_ID = "1"
)

}
\seealso{
\code{\link{pop_model_setup}} for setting up population model parameters
\code{\link{pop_model_matrix_elements}} for building the projection matrix
\code{\link{build_k_for_proj_dd}} for building K values from habitat data
\code{\link{Projection_DD}} for running the population projection
}
